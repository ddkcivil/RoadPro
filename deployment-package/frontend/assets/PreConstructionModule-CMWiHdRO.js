import{c as B,r as m,j as e,B as d,P as y,a0 as U,a1 as J,a2 as X,n as C,t as $,O as z,J as H,a6 as K,$ as W,D,e as S,f as w,h as b,K as n,V as Y,W as Z,X as G,Y as Q,Z as u,I as c,U as _,k,a8 as T,a7 as ee}from"./index-CewaSTRD.js";import{T as se}from"./triangle-alert-DCByPDj1.js";import{C as A}from"./circle-check-ClQeHiCK.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=B("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),ie=({project:r,onProjectUpdate:v})=>{const[F,x]=m.useState(!1),[P,g]=m.useState(!1),[f,O]=m.useState(null),[t,l]=m.useState({category:"Survey",status:"Pending",description:"",remarks:"",estStartDate:"",estEndDate:"",progress:0}),[a,h]=m.useState({date:new Date().toISOString().split("T")[0],progressAdded:0,description:""}),I=s=>{if(s.preventDefault(),r.preConstruction.some(o=>{var j;return o.description.toLowerCase()===((j=t.description)==null?void 0:j.toLowerCase())})){ee.error("Duplicate: An activity with this description already exists.");return}const i={id:`pre-${Date.now()}`,category:t.category,description:t.description||"",status:t.status,targetDate:t.estEndDate||"",estStartDate:t.estStartDate,estEndDate:t.estEndDate,progress:0,remarks:t.remarks||"",logs:[]};v({...r,preConstruction:[...r.preConstruction,i]}),x(!1),l({category:"Survey",status:"Pending",description:"",remarks:"",estStartDate:"",estEndDate:"",progress:0})},q=s=>{window.confirm("Are you sure you want to delete this activity? This action cannot be undone.")&&v({...r,preConstruction:r.preConstruction.filter(p=>p.id!==s)})},L=s=>{if(s.preventDefault(),!f)return;const p=r.preConstruction.map(i=>{if(i.id===f){const o=Math.min(100,(i.progress||0)+Number(a.progressAdded)),j={date:a.date,progressAdded:Number(a.progressAdded),description:a.description},V=o===100?"Completed":o>0?"In Progress":i.status;return{...i,progress:o,status:V,logs:[...i.logs||[],j]}}return i});v({...r,preConstruction:p}),g(!1),h({date:new Date().toISOString().split("T")[0],progressAdded:0,description:""})},M=s=>{switch(s){case"Completed":return"success";case"In Progress":return"default";default:return"secondary"}},R=new Date().toISOString().split("T")[0],N=r.preConstruction.filter(s=>s.status!=="Completed"&&s.estEndDate&&s.estEndDate<=R);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between mb-4 items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-primary tracking-widest uppercase",children:"PRE-CONSTRUCTION"}),e.jsx("h1",{className:"text-3xl font-black text-foreground",children:"Pre-Construction Activities"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Land Acquisition, Clearances, and Surveys"})]}),e.jsxs(d,{onClick:()=>x(!0),children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Add Activity"]})]}),N.length>0&&e.jsxs(U,{variant:"default",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsxs(J,{children:["Action Required: ",N.length," Tasks Due or Overdue"]}),e.jsx(X,{children:e.jsx("ul",{className:"list-disc list-inside mt-1",children:N.map(s=>e.jsxs("li",{children:[s.description," (Due: ",s.estEndDate,")"]},s.id))})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[r.preConstruction.map(s=>e.jsxs(C,{className:"flex flex-col",children:[e.jsxs($,{className:"flex-1 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx(z,{variant:M(s.status||"Pending"),children:s.status}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>q(s.id),title:"Delete Activity",children:e.jsx(H,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs font-bold text-muted-foreground uppercase mb-1",children:s.category}),e.jsx("h3",{className:"text-lg font-bold mb-3",children:s.description}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(K,{className:"h-4 w-4"})," Est: ",s.estStartDate||"N/A"," â†’ ",s.estEndDate||"N/A"]})}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Progress"}),e.jsxs("p",{className:"text-sm font-bold",children:[s.progress||0,"%"]})]}),e.jsx(W,{value:s.progress||0})]}),s.remarks&&e.jsxs("div",{className:"p-2 bg-muted rounded-md text-sm italic text-muted-foreground",children:['"',s.remarks,'"']})]}),e.jsx("div",{className:"p-4 border-t",children:e.jsxs(d,{className:"w-full",variant:"outline",onClick:()=>{O(s.id),g(!0)},children:[e.jsx(E,{className:"mr-2 h-4 w-4"})," Track Daily Progress"]})})]},s.id)),r.preConstruction.length===0&&e.jsx("div",{className:"lg:col-span-3",children:e.jsx(C,{className:"p-12 text-center border-dashed",children:e.jsx("p",{className:"text-muted-foreground italic",children:"No pre-construction activities logged."})})})]}),e.jsx(D,{open:F,onOpenChange:x,children:e.jsxs(S,{className:"sm:max-w-[425px]",children:[e.jsx(w,{children:e.jsxs(b,{className:"flex items-center text-lg font-bold text-primary",children:[e.jsx(y,{className:"mr-2 h-5 w-5"})," Add Pre-Construction Activity"]})}),e.jsxs("form",{onSubmit:I,className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"category",children:"Category"}),e.jsxs(Y,{value:t.category,onValueChange:s=>l({...t,category:s}),children:[e.jsx(Z,{id:"category",children:e.jsx(G,{placeholder:"Select a category"})}),e.jsxs(Q,{children:[e.jsx(u,{value:"Survey",children:"Survey"}),e.jsx(u,{value:"Land Acquisition",children:"Land Acquisition"}),e.jsx(u,{value:"Forest Clearance",children:"Forest Clearance"}),e.jsx(u,{value:"Utility Shifting",children:"Utility Shifting"}),e.jsx(u,{value:"Design",children:"Design"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(c,{id:"description",required:!0,value:t.description,onChange:s=>l({...t,description:s.target.value}),placeholder:"e.g. Joint Verification"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"est-start",children:"Est. Start"}),e.jsx(c,{id:"est-start",required:!0,type:"date",value:t.estStartDate,onChange:s=>l({...t,estStartDate:s.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"est-end",children:"Est. End"}),e.jsx(c,{id:"est-end",required:!0,type:"date",value:t.estEndDate,onChange:s=>l({...t,estEndDate:s.target.value})})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"remarks",children:"Remarks"}),e.jsx(_,{id:"remarks",value:t.remarks,onChange:s=>l({...t,remarks:s.target.value})})]}),e.jsxs(k,{children:[e.jsxs(d,{variant:"outline",onClick:()=>x(!1),children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"Cancel"]}),e.jsxs(d,{type:"submit",children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),"Add Activity"]})]})]})]})}),e.jsx(D,{open:P,onOpenChange:g,children:e.jsxs(S,{className:"sm:max-w-[425px]",children:[e.jsx(w,{children:e.jsxs(b,{className:"flex items-center text-lg font-bold text-primary",children:[e.jsx(E,{className:"mr-2 h-5 w-5"})," Track Daily Progress"]})}),e.jsxs("form",{onSubmit:L,className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"track-date",children:"Date"}),e.jsx(c,{id:"track-date",type:"date",required:!0,value:a.date,onChange:s=>h({...a,date:s.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"progress-added",children:"Progress Added (%)"}),e.jsx(c,{id:"progress-added",type:"number",required:!0,value:a.progressAdded,onChange:s=>h({...a,progressAdded:Number(s.target.value)})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter incremental percentage completed today."})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"description",children:"Description / Activity"}),e.jsx(c,{id:"description",required:!0,placeholder:"e.g. Field work done",value:a.description,onChange:s=>h({...a,description:s.target.value})})]}),e.jsxs(k,{children:[e.jsxs(d,{type:"button",variant:"outline",onClick:()=>g(!1),children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"Cancel"]}),e.jsxs(d,{type:"submit",children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),"Update Progress"]})]})]})]})})]})};export{ie as default};
