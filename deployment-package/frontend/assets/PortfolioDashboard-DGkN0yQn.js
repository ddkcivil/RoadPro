import{c as q,r as E,j as e,n as o,t as d,ah as x,ay as B,$ as n,aw as u,m as y,u as F,I as O,az as R,aA as J,O as k,ab as Q,M as C,a5 as T,T as G,E as _,F as $,B as K,J as W,H as X,ax as Y,ac as j}from"./index-CewaSTRD.js";import{f as Z}from"./exportUtils-B5u6ZY-6.js";import{C as A}from"./clock-CdXHNXMZ.js";import"./currencyUtils-RmnVW5tT.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=q("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]),ce=({projects:i,userRole:N,settings:M,onSelectProject:H,onSaveProject:se,onDeleteProject:S})=>{const[h,z]=E.useState(""),m=i.length,b=i.filter(s=>{const a=new Date,t=new Date(s.startDate),r=new Date(s.endDate);return a.setHours(0,0,0,0),t.setHours(0,0,0,0),r.setHours(0,0,0,0),t<=a&&r>=a}).length,g=i.filter(s=>{const a=new Date,t=new Date(s.startDate);return a.setHours(0,0,0,0),t.setHours(0,0,0,0),t>a}).length,f=i.filter(s=>{const a=new Date,t=new Date(s.endDate);return a.setHours(0,0,0,0),t.setHours(0,0,0,0),t<a}).length,L=i.reduce((s,a)=>{var r;const t=((r=a.agencies)==null?void 0:r.reduce((c,l)=>c+(l.contractValue||0),0))||0;return s+t},0),v=i.filter(s=>s.name.toLowerCase().includes(h.toLowerCase())||s.client.toLowerCase().includes(h.toLowerCase())||s.code.toLowerCase().includes(h.toLowerCase())),I=s=>{S(s)},U=s=>{H(s)},w=s=>{const a=s||[],t=a.reduce((c,l)=>c+((l==null?void 0:l.quantity)||0)*((l==null?void 0:l.rate)||0),0);if(t===0)return 0;const r=a.reduce((c,l)=>c+((l==null?void 0:l.completedQuantity)||0)*((l==null?void 0:l.rate)||0),0);return Math.round(r/t*100)},p=(s,a)=>{if(!s||!a)return 0;const t=new Date(s).getTime(),r=new Date(a).getTime(),c=new Date().getTime();return c<t?0:c>r?100:Math.round((c-t)/(r-t)*100)},V=(s,a)=>{const t=new Date,r=new Date(s),c=new Date(a);return t.setHours(0,0,0,0),r.setHours(0,0,0,0),c.setHours(0,0,0,0),s?a&&c<t?{label:"Completed",color:"bg-blue-50 text-blue-700 border-blue-200",dot:"bg-blue-500",icon:e.jsx(u,{size:12,className:"mr-1"})}:r>t?{label:"Upcoming",color:"bg-amber-50 text-amber-700 border-amber-200",dot:"bg-amber-400",icon:e.jsx(A,{size:12,className:"mr-1"})}:{label:"Active",color:"bg-emerald-50 text-emerald-700 border-emerald-200",dot:"bg-emerald-500",icon:e.jsx(u,{size:12,className:"mr-1"})}:{label:"Draft",color:"bg-slate-100 text-slate-600 border-slate-200",dot:"bg-slate-400",icon:e.jsx(j,{size:12,className:"mr-1"})}},P=Math.round(i.reduce((s,a)=>s+w(a.boq),0)/(i.length||1)),D=Math.round(i.reduce((s,a)=>s+p(a.startDate,a.endDate),0)/(i.length||1));return e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Portfolio Dashboard"}),e.jsxs("p",{className:"text-sm text-slate-500 mb-4",children:["Strategic overview of ",m," infrastructure assets"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(o,{className:"h-full",children:e.jsxs(d,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(x,{className:"h-12 w-12 bg-indigo-600 text-white",children:e.jsx(B,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:m}),e.jsx("p",{className:"text-sm text-slate-500",children:"Total Projects"})]})]}),e.jsx(n,{value:100,className:"h-1.5 [&::-webkit-progress-bar]:bg-slate-200 [&::-webkit-progress-value]:bg-indigo-600"})]})}),e.jsx(o,{className:"h-full",children:e.jsxs(d,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(x,{className:"h-12 w-12 bg-emerald-600 text-white",children:e.jsx(u,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:b}),e.jsx("p",{className:"text-sm text-slate-500",children:"Active Projects"})]})]}),e.jsx(n,{value:Math.round(b/m*100)||0,className:"h-1.5 [&::-webkit-progress-bar]:bg-slate-200 [&::-webkit-progress-value]:bg-emerald-600"})]})}),e.jsx(o,{className:"h-full",children:e.jsxs(d,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(x,{className:"h-12 w-12 bg-amber-600 text-white",children:e.jsx(A,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:g}),e.jsx("p",{className:"text-sm text-slate-500",children:"Upcoming Projects"})]})]}),e.jsx(n,{value:Math.round(g/m*100)||0,className:"h-1.5 [&::-webkit-progress-bar]:bg-slate-200 [&::-webkit-progress-value]:bg-amber-600"})]})}),e.jsx(o,{className:"h-full",children:e.jsxs(d,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(x,{className:"h-12 w-12 bg-sky-600 text-white",children:e.jsx(y,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:Z(L,M)}),e.jsx("p",{className:"text-sm text-slate-500",children:"Portfolio Value"})]})]}),e.jsx(n,{value:100,className:"h-1.5 [&::-webkit-progress-bar]:bg-slate-200 [&::-webkit-progress-value]:bg-sky-600"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsx(o,{className:"h-full",children:e.jsxs(d,{className:"p-4",children:[e.jsxs("h2",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5"})," Average Progress"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Physical Progress"}),e.jsxs("p",{className:"text-sm font-semibold text-emerald-600",children:[P,"%"]})]}),e.jsx(n,{value:P,className:"h-2 [&::-webkit-progress-bar]:bg-slate-200 [&::-webkit-progress-value]:bg-emerald-600"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Time Progress"}),e.jsxs("p",{className:"text-sm font-semibold text-indigo-600",children:[D,"%"]})]}),e.jsx(n,{value:D,className:"h-2 [&::-webkit-progress-bar]:bg-slate-200 [&::-webkit-progress-value]:bg-indigo-600"})]})]})]})}),e.jsx(o,{className:"h-full",children:e.jsxs(d,{className:"p-4",children:[e.jsxs("h2",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"})," Project Status Distribution"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-3 w-3 bg-emerald-500 rounded-full"}),e.jsx("p",{className:"text-sm",children:"Active"})]}),e.jsx("p",{className:"text-sm font-semibold",children:b})]}),e.jsx(n,{value:Math.round(b/m*100)||0,className:"h-1.5 [&::-webkit-progress-bar]:bg-slate-200 [&::-webkit-progress-value]:bg-emerald-500"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-3 w-3 bg-amber-500 rounded-full"}),e.jsx("p",{className:"text-sm",children:"Upcoming"})]}),e.jsx("p",{className:"text-sm font-semibold",children:g})]}),e.jsx(n,{value:Math.round(g/m*100)||0,className:"h-1.5 [&::-webkit-progress-bar]:bg-slate-200 [&::-webkit-progress-value]:bg-amber-500"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-3 w-3 bg-sky-500 rounded-full"}),e.jsx("p",{className:"text-sm",children:"Completed"})]}),e.jsx("p",{className:"text-sm font-semibold",children:f})]}),e.jsx(n,{value:Math.round(f/m*100)||0,className:"h-1.5 [&::-webkit-progress-bar]:bg-slate-200 [&::-webkit-progress-value]:bg-sky-500"})]})]})]})})]}),e.jsx(o,{className:"mb-6",children:e.jsxs(d,{className:"p-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Project Directory"}),e.jsxs("div",{className:"relative w-full sm:w-auto flex-grow",children:[e.jsx(F,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(O,{placeholder:"Search by code or client...",value:h,onChange:s=>z(s.target.value),className:"pl-10 w-full"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.map(s=>{var c,l;const a=w(s.boq),t=p(s.startDate,s.endDate),r=V(s.startDate,s.endDate);return e.jsx(o,{className:"h-full transition-transform hover:-translate-y-1 hover:shadow-lg",children:e.jsxs(d,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between mb-2 items-start",children:[e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>U(s.id),children:[e.jsxs(x,{className:"h-14 w-14 rounded-lg bg-indigo-100 text-indigo-700 font-bold",children:[e.jsx(R,{src:s.logo}),e.jsx(J,{children:s.name.charAt(0)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold leading-tight",children:s.name}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(k,{variant:"secondary",children:s.code}),e.jsx(Q,{className:"h-3 w-3"})," ",s.location]})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs(k,{className:C("mb-1",r.dot),children:[r.icon," ",r.label]}),(N===T.ADMIN||N===T.PROJECT_MANAGER)&&e.jsx(G,{children:e.jsxs(_,{children:[e.jsx($,{asChild:!0,children:e.jsx(K,{variant:"ghost",size:"icon",onClick:()=>I(s.id),children:e.jsx(W,{className:"h-4 w-4 text-destructive"})})}),e.jsx(X,{children:"Delete Project"})]})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-4",children:[e.jsx(Y,{className:"h-4 w-4"})," ",((c=s.agencies)==null?void 0:c.length)||0," Agencies",e.jsx(j,{className:"h-4 w-4 ml-2"})," ",((l=s.boq)==null?void 0:l.length)||0," BOQ Items"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground",children:"Physical Progress"}),e.jsxs("p",{className:"text-xs font-semibold text-emerald-600",children:[a,"%"]})]}),e.jsx(n,{value:a,className:"h-2 [&::-webkit-progress-bar]:bg-slate-200 [&::-webkit-progress-value]:bg-emerald-600"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground",children:"Timeline"}),e.jsxs("p",{className:"text-xs font-semibold text-indigo-600",children:[t,"%"]})]}),e.jsx(n,{value:t,className:"h-2 [&::-webkit-progress-bar]:bg-slate-200",indicatorClassName:C(t>a?"bg-destructive":"bg-indigo-600")})]})]})]})},s.id)})}),v.length===0&&e.jsxs(o,{className:"text-center p-8 border-dashed",children:[e.jsx(j,{className:"h-12 w-12 text-muted-foreground mx-auto mb-2"}),e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"No Projects Found"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"No projects match your search criteria."})]})]})};export{ce as default};
