import{r as o,a5 as h,j as e,n as j,B as c,ah as C,az as E,aA as y,K as l,I as i,a8 as A,V as F,W as I,X as U,Y as q,Z as k,a0 as G,a1 as T,a2 as Y}from"./index-CewaSTRD.js";import{U as N}from"./user-plus-CMrYzzGb.js";import{U as z}from"./upload-CcYQvXh5.js";const V=()=>{const[a,t]=o.useState({name:"",email:"",role:h.SITE_ENGINEER,phone:"",password:"",confirmPassword:""}),[w,m]=o.useState(null),[v,d]=o.useState(null),[f,p]=o.useState(!1),[r,u]=o.useState({}),P=()=>{const s={};return a.name.trim()||(s.name="Name is required"),a.email.trim()?/^[\w\.-]+@[\w\.-]+\.[a-zA-Z]{2,}$/.test(a.email)||(s.email="Please enter a valid email address"):s.email="Email is required",a.password?a.password.length<6&&(s.password="Password must be at least 6 characters"):s.password="Password is required",a.password!==a.confirmPassword&&(s.confirmPassword="Passwords do not match"),a.phone&&!/^\+?[1-9][\d\-\s]{8,}$/.test(a.phone)&&(s.phone="Please enter a valid phone number"),u(s),Object.keys(s).length===0},b=async s=>{if(s.preventDefault(),!!P())try{await apiService.submitRegistration({name:a.name,email:a.email,phone:a.phone,requestedRole:a.role}),p(!0),t({name:"",email:"",role:h.SITE_ENGINEER,phone:"",password:"",confirmPassword:""}),m(null),d(null)}catch(n){u({email:n.message||"Registration failed"})}},R=s=>{var g;const n=(g=s.target.files)==null?void 0:g[0];if(n){m(n);const x=new FileReader;x.onloadend=()=>{d(x.result)},x.readAsDataURL(n)}},S=()=>{m(null),d(null)};return f?e.jsx("div",{className:"min-h-[calc(100vh-140px)] flex flex-col justify-center items-center p-4",children:e.jsxs(j,{className:"p-6 text-center max-w-lg w-full rounded-2xl",children:[e.jsx(N,{className:"mx-auto text-green-500 mb-4 h-16 w-16"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Registration Submitted"}),e.jsx("p",{className:"text-slate-600 mb-4",children:"Your account registration has been submitted successfully."}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"An administrator will review your request and approve your account. You will receive an email notification once your account is approved."}),e.jsx(c,{onClick:()=>p(!1),className:"mt-4",children:"Register Another Account"})]})}):e.jsxs("div",{className:"p-4 overflow-y-auto min-h-[calc(100vh-140px)]",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Create Account"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Register for a new RoadMaster Pro account"})]}),e.jsx(j,{className:"p-6 rounded-2xl max-w-2xl mx-auto",children:e.jsxs("form",{onSubmit:b,className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs(C,{className:"w-16 h-16",children:[e.jsx(E,{src:v||void 0}),e.jsx(y,{children:a.name?a.name.charAt(0):"U"})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx(c,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(l,{htmlFor:"avatar-upload",children:[e.jsx(z,{className:"mr-2 h-4 w-4"})," Upload Photo"]})}),e.jsx(i,{id:"avatar-upload",type:"file",className:"sr-only",accept:"image/*",onChange:R}),w&&e.jsxs(c,{variant:"ghost",size:"sm",onClick:S,children:[e.jsx(A,{className:"mr-2 h-4 w-4"})," Clear Photo"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"JPG, PNG, Max 5MB"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(l,{htmlFor:"name",className:"text-right",children:"Full Name"}),e.jsx(i,{id:"name",value:a.name,onChange:s=>t({...a,name:s.target.value}),className:"col-span-3"}),r.name&&e.jsx("p",{className:"col-start-2 col-span-3 text-sm text-red-500",children:r.name})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(l,{htmlFor:"email",className:"text-right",children:"Email"}),e.jsx(i,{id:"email",type:"email",value:a.email,onChange:s=>t({...a,email:s.target.value}),className:"col-span-3"}),r.email&&e.jsx("p",{className:"col-start-2 col-span-3 text-sm text-red-500",children:r.email})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(l,{htmlFor:"password",className:"text-right",children:"Password"}),e.jsx(i,{id:"password",type:"password",value:a.password,onChange:s=>t({...a,password:s.target.value}),className:"col-span-3"}),r.password&&e.jsx("p",{className:"col-start-2 col-span-3 text-sm text-red-500",children:r.password})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(l,{htmlFor:"confirmPassword",className:"text-right",children:"Confirm Password"}),e.jsx(i,{id:"confirmPassword",type:"password",value:a.confirmPassword,onChange:s=>t({...a,confirmPassword:s.target.value}),className:"col-span-3"}),r.confirmPassword&&e.jsx("p",{className:"col-start-2 col-span-3 text-sm text-red-500",children:r.confirmPassword})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(l,{htmlFor:"phone",className:"text-right",children:"Phone"}),e.jsx(i,{id:"phone",value:a.phone,onChange:s=>t({...a,phone:s.target.value}),className:"col-span-3"}),r.phone&&e.jsx("p",{className:"col-start-2 col-span-3 text-sm text-red-500",children:r.phone})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(l,{htmlFor:"role",className:"text-right",children:"Request Role"}),e.jsxs(F,{value:a.role,onValueChange:s=>t({...a,role:s}),children:[e.jsx(I,{className:"col-span-3",children:e.jsx(U,{placeholder:"Select a role"})}),e.jsx(q,{children:Object.values(h).map(s=>e.jsx(k,{value:s,children:s},s))})]})]}),e.jsxs(G,{className:"mt-4",children:[e.jsx(T,{children:"Important Note"}),e.jsx(Y,{children:"Your registration will be reviewed by an administrator. You will receive an email notification when your account is approved."})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(c,{variant:"outline",onClick:()=>{t({name:"",email:"",role:h.SITE_ENGINEER,phone:"",password:"",confirmPassword:""}),m(null),d(null)},className:"flex-1",children:"Clear"}),e.jsxs(c,{type:"submit",className:"flex-1",children:[e.jsx(N,{className:"mr-2 h-4 w-4"}),"Submit Registration"]})]})]})})]})};export{V as default};
