import{c as m,r as h,j as e,B as l,P as E,n as N,$ as R,o as H,p as O,t as W,v as I,w as z,x as b,y as n,z as A,A as d,J as V,D as G,e as Z,f as $,h as Y,K as c,V as f,W as k,X as S,Y as L,Z as x,I as v,k as q,a7 as _,L as J}from"./index-CewaSTRD.js";import{T as X,a as Q,b as U,c as ee}from"./tabs-b2piEQ7z.js";import{H as ae}from"./history-DhVPXOxI.js";import{F as se}from"./filter-BSFQ0ETk.js";import{S as ie}from"./shield-check-BgAnWJJY.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=m("Footprints",[["path",{d:"M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 10 3.8 10 5.5c0 3.11-2 5.66-2 8.68V16a2 2 0 1 1-4 0Z",key:"1dudjm"}],["path",{d:"M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 14 7.8 14 9.5c0 3.11 2 5.66 2 8.68V20a2 2 0 1 0 4 0Z",key:"l2t8xc"}],["path",{d:"M16 17h4",key:"1dejxt"}],["path",{d:"M4 13h4",key:"1bwh8b"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=m("Grid2x2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=m("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=m("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]),de=[{id:"Pavement",icon:e.jsx(J,{size:18}),label:"Pavement"},{id:"Drainage",icon:e.jsx(ne,{size:18}),label:"Drainage"},{id:"Footpath",icon:e.jsx(te,{size:18}),label:"Footpath"},{id:"Median",icon:e.jsx(re,{size:18}),label:"Median & Kerbs"}],T={Pavement:["Embankment","Subgrade","GSB","WMM","Prime Coat","Tack Coat","DBM","BC","Concrete Pavement"],Drainage:["Trench Excavation","PCC Bedding","Wall Construction","Cover Slab","Finishing / Plastering"],Footpath:["Subgrade Prep","Granular Base","Kerb Stone Fixing","Tactile Pavers","Interlocking Blocks"],Median:["Curb Casting","Soil Filling","Landscape Preparation","W-Beam Barrier"]},pe=({project:g,onProjectUpdate:y,userRole:ce})=>{const[i,w]=h.useState("Pavement"),[M,o]=h.useState(!1),[s,t]=h.useState({category:"Pavement",date:new Date().toISOString().split("T")[0],side:"Both",layer:""}),j=g.linearWorks||[],p=j.filter(a=>a.category===i),D=h.useMemo(()=>(T[i]||[]).map(r=>{const K=p.filter(u=>u.layer===r).reduce((u,C)=>u+(C.endChainage-C.startChainage),0);return{layer:r,totalKm:K}}),[p,i]),F=()=>{if(!s.layer||s.startChainage===void 0||s.endChainage===void 0)return;const a={id:`lin-${Date.now()}`,category:i,layer:s.layer,startChainage:Number(s.startChainage),endChainage:Number(s.endChainage),date:s.date,side:s.side||"Both",status:"Completed"};y({...g,linearWorks:[...j,a]}),o(!1),t({category:i,date:new Date().toISOString().split("T")[0],side:"Both",layer:""})},P=a=>{confirm("Delete this work log?")&&y({...g,linearWorks:j.filter(r=>r.id!==a)})},B=()=>{_("Preparing high-fidelity PDF export of linear works history...")};return e.jsxs("div",{className:"animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex justify-between mb-4 items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Linear Operations"}),e.jsx("p",{className:"text-muted-foreground",children:"Kilometer-wise progress of pavement and utilities"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(l,{variant:"outline",onClick:B,children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Export History"]}),e.jsxs(l,{onClick:()=>o(!0),children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"Log Progress"]})]})]}),e.jsx(N,{children:e.jsxs(X,{value:i,onValueChange:w,children:[e.jsx(Q,{children:de.map(a=>e.jsxs(U,{value:a.id,children:[a.icon,e.jsx("span",{className:"ml-2",children:a.label})]},a.id))}),e.jsx(ee,{value:i,className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx("h2",{className:"text-sm font-semibold mb-2",children:"CATEGORY COVERAGE"}),e.jsx("div",{className:"space-y-4",children:D.map(a=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:a.layer}),e.jsxs("span",{className:"text-sm font-bold text-primary",children:[a.totalKm.toFixed(3)," Km"]})]}),e.jsx(R,{value:Math.min(100,a.totalKm/15*100)})]},a.layer))})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(N,{children:[e.jsx(H,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(O,{children:["History: ",i]}),e.jsx(l,{variant:"ghost",size:"icon",children:e.jsx(se,{className:"h-4 w-4"})})]})}),e.jsx(W,{children:e.jsxs(I,{children:[e.jsx(z,{children:e.jsxs(b,{children:[e.jsx(n,{children:"Date"}),e.jsx(n,{children:"Layer"}),e.jsx(n,{children:"Range"}),e.jsx(n,{children:"Side"}),e.jsx(n,{className:"text-right",children:"Actions"})]})}),e.jsx(A,{children:p.sort((a,r)=>new Date(r.date).getTime()-new Date(a.date).getTime()).map(a=>e.jsxs(b,{children:[e.jsx(d,{children:a.date}),e.jsx(d,{children:a.layer}),e.jsx(d,{children:`${a.startChainage.toFixed(3)} - ${a.endChainage.toFixed(3)}`}),e.jsx(d,{children:a.side}),e.jsx(d,{className:"text-right",children:e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>P(a.id),children:e.jsx(V,{className:"h-4 w-4"})})})]},a.id))})]})})]})})]})})]})}),e.jsx(G,{open:M,onOpenChange:o,children:e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(Y,{className:"flex items-center",children:[e.jsx(le,{className:"mr-2 text-indigo-600"})," Log Progress"]})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(c,{htmlFor:"layer",className:"text-right",children:"Layer"}),e.jsxs(f,{value:s.layer,onValueChange:a=>t({...s,layer:a}),children:[e.jsx(k,{id:"layer",className:"col-span-3",children:e.jsx(S,{placeholder:"Select a layer"})}),e.jsx(L,{children:(T[i]||[]).map(a=>e.jsx(x,{value:a,children:a},a))})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(c,{htmlFor:"startKm",className:"text-right",children:"Start Km"}),e.jsx(v,{id:"startKm",type:"number",value:s.startChainage,onChange:a=>t({...s,startChainage:Number(a.target.value)}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(c,{htmlFor:"endKm",className:"text-right",children:"End Km"}),e.jsx(v,{id:"endKm",type:"number",value:s.endChainage,onChange:a=>t({...s,endChainage:Number(a.target.value)}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(c,{className:"text-right",children:"Side"}),e.jsx("div",{className:"col-span-3",children:e.jsxs(f,{value:s.side,onValueChange:a=>t({...s,side:a}),children:[e.jsx(k,{children:e.jsx(S,{})}),e.jsxs(L,{children:[e.jsx(x,{value:"LHS",children:"LHS"}),e.jsx(x,{value:"RHS",children:"RHS"}),e.jsx(x,{value:"Both",children:"BOTH"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(c,{htmlFor:"date",className:"text-right",children:"Date"}),e.jsx(v,{id:"date",type:"date",value:s.date,onChange:a=>t({...s,date:a.target.value}),className:"col-span-3"})]})]}),e.jsxs(q,{children:[e.jsx(l,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsxs(l,{onClick:F,disabled:!s.layer,children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Certify Log"]})]})]})})]})};export{pe as default};
