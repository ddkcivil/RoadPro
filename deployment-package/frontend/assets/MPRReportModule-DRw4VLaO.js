import{c as me,r as D,j as e,n as i,K as oe,I as je,B as S,ac as ge,Q as Ne,t as n,m as pe,a6 as Z,ax as _,O as r,aL as ue,v as g,w as N,x as c,A as a,z as p,aa as ee,aI as fe,aN as ve,aE as se,a0 as ae,a2 as te,a$ as be,ab as ye,D as Se,e as we,f as De,h as _e,ah as k,k as ke}from"./index-CewaSTRD.js";import{T as Pe,a as Ce,b as j}from"./tabs-b2piEQ7z.js";import{f as d}from"./exportUtils-B5u6ZY-6.js";import{F as Re}from"./file-spreadsheet-B5YUu3jb.js";import{B as Te}from"./book-open-BI8Hswt2.js";import{I as le}from"./image-Bteq2faF.js";import{R as Ae}from"./receipt-DojscuDk.js";import{T as ie}from"./triangle-alert-DCByPDj1.js";import"./currencyUtils-RmnVW5tT.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=me("FilePenLine",[["path",{d:"m18 5-2.414-2.414A2 2 0 0 0 14.172 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2",key:"142zxg"}],["path",{d:"M21.378 12.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"2t3380"}],["path",{d:"M8 18h1",key:"13wk12"}]]),Ue=({project:t,settings:x,onProjectUpdate:qe,userRole:Me})=>{var C,R,T,A,q,M,Q,B,I,E,z,F,O,L,V,U,$,W,H,G,K,J,Y;const[P,ce]=D.useState(new Date().toISOString().slice(0,7)),[o,re]=D.useState(0),[xe,y]=D.useState(!1),h={original:t.boq.reduce((s,l)=>s+l.quantity*l.rate,0),variation:t.boq.reduce((s,l)=>s+(l.variationQuantity||0)*l.rate,0),revised:t.boq.reduce((s,l)=>s+l.quantity*l.rate+(l.variationQuantity||0)*l.rate,0),progressValue:t.boq.reduce((s,l)=>s+l.completedQuantity*l.rate,0)},u={planned:t.schedule.reduce((s,l)=>s+l.progress/100,0)/t.schedule.length||0,actual:t.boq.reduce((s,l)=>s+l.completedQuantity/l.quantity,0)/t.boq.length||0},de=()=>{y(!0)},he=()=>{alert("Monthly Progress Report would be exported in the specified format"),y(!1)},f=()=>t.weather?t.weather:null,w=()=>t.environmentRegistry||null;return e.jsxs("div",{className:"h-[calc(100vh-140px)] flex gap-3",children:[e.jsxs(i,{className:"w-[300px] rounded-3xl flex flex-col overflow-hidden border",children:[e.jsxs("div",{className:"p-6 border-b bg-slate-50",children:[e.jsx("h2",{className:"text-lg font-black",children:"MPR Generator"}),e.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Monthly Progress Report"}),e.jsxs("div",{className:"mb-4",children:[e.jsx(oe,{htmlFor:"report-month",children:"Reporting Month"}),e.jsx(je,{id:"report-month",type:"month",value:P,onChange:s=>ce(s.target.value)})]}),e.jsxs(S,{className:"w-full",onClick:de,children:[e.jsx(ge,{size:18,className:"mr-2"}),"Generate MPR"]})]}),e.jsxs("div",{className:"flex-1 p-4 overflow-auto",children:[e.jsx("h3",{className:"text-sm font-bold mb-4",children:"PROJECT STATS"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(i,{className:"p-3 text-center bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Planned"}),e.jsxs("p",{className:"text-lg font-bold",children:[(u.planned*100).toFixed(1),"%"]})]}),e.jsxs(i,{className:"p-3 text-center bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Actual"}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:[(u.actual*100).toFixed(1),"%"]})]})]}),e.jsx(Ne,{className:"my-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold",children:"BOQ Items"}),e.jsx("span",{className:"text-sm",children:t.boq.length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold",children:"Active Tasks"}),e.jsx("span",{className:"text-sm",children:t.schedule.filter(s=>s.status!=="Completed").length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold",children:"Structures"}),e.jsx("span",{className:"text-sm",children:((C=t.structures)==null?void 0:C.length)||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold",children:"Active NCRs"}),e.jsx("span",{className:"text-sm",children:t.ncrs.filter(s=>s.status!=="Closed").length})]})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx(Pe,{value:o.toString(),onValueChange:s=>re(parseInt(s)),className:"border-b",children:e.jsxs(Ce,{children:[e.jsx(j,{value:"0",children:"Executive Summary"}),e.jsx(j,{value:"1",children:"Physical Progress"}),e.jsx(j,{value:"2",children:"Financial Progress"}),e.jsx(j,{value:"3",children:"Resources"}),e.jsx(j,{value:"4",children:"Quality & Safety"}),e.jsx(j,{value:"5",children:"Environmental"}),e.jsx(j,{value:"6",children:"Endorsement"}),e.jsx(j,{value:"7",children:"Issues"}),e.jsx(j,{value:"8",children:"Photos"})]})}),e.jsxs("div",{className:"p-6",children:[o===0&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(Re,{size:20,className:"text-indigo-600"})," Financial Overview"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs(i,{className:"p-4 text-center bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Original"}),e.jsx("p",{className:"text-lg font-bold",children:d(h.original,x)})]}),e.jsxs(i,{className:"p-4 text-center bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Variation"}),e.jsx("p",{className:"text-lg font-bold",children:d(h.variation,x)})]}),e.jsxs(i,{className:"p-4 text-center bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Revised"}),e.jsx("p",{className:"text-lg font-bold",children:d(h.revised,x)})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Progress Value"}),e.jsx(i,{className:"p-4 bg-slate-50",children:e.jsx("p",{className:"text-2xl font-black text-green-600",children:d(h.progressValue,x)})})]})]})}),e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(pe,{size:20,className:"text-indigo-600"})," Physical Progress"]}),e.jsx("div",{className:"flex items-center gap-4 mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Planned vs Actual"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-indigo-600 w-[${physicalProgress.planned * 100}%]"})}),e.jsxs("p",{className:"text-xs",children:[(u.planned*100).toFixed(1),"%"]})]})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Key Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(i,{className:"p-3 text-center",children:[e.jsx("p",{className:"text-lg font-bold text-green-600",children:"+12%"}),e.jsx("p",{className:"text-xs",children:"MoM Growth"})]}),e.jsxs(i,{className:"p-3 text-center",children:[e.jsx("p",{className:"text-lg font-bold text-red-600",children:"-3%"}),e.jsx("p",{className:"text-xs",children:"Delay"})]})]})]})]})}),e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(Z,{size:20,className:"text-indigo-600"})," Contract & Timeline"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs(i,{className:"p-4 bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Contract Duration"}),e.jsx("p",{className:"text-lg font-black",children:t.contractPeriod||"TBD"})]}),e.jsxs(i,{className:"p-4 bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Elapsed Time"}),e.jsxs("p",{className:"text-lg font-black",children:[(t.schedule.length>0?t.schedule.filter(s=>s.status==="Completed").length/t.schedule.length*100:0).toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Milestones"}),e.jsx(i,{className:"p-4 bg-slate-50",children:e.jsxs("p",{className:"text-sm",children:[((R=t.milestones)==null?void 0:R.length)||0," Total, ",((T=t.milestones)==null?void 0:T.filter(s=>s.status==="Completed").length)||0," Completed"]})})]})]})}),e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(_,{size:20,className:"text-indigo-600"})," Key Personnel"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-bold",children:"Project Manager"}),e.jsx("span",{className:"text-xs text-slate-500",children:t.projectManager||"TBD"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-bold",children:"Engineer"}),e.jsx("span",{className:"text-xs text-slate-500",children:t.engineer||"TBD"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-bold",children:"Supervisor"}),e.jsx("span",{className:"text-xs text-slate-500",children:t.supervisor||"TBD"})]})]})]})}),e.jsx(i,{className:"rounded-3xl col-span-full",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(Te,{size:20,className:"text-indigo-600"})," Project Summary"]}),e.jsxs("p",{className:"text-sm mb-4",children:["The project is currently executing ",t.boq.length," BOQ items across ",((A=t.structures)==null?void 0:A.length)||0," structural assets. As of ",new Date().toLocaleDateString(),", the physical progress stands at ",(u.actual*100).toFixed(1),"% against the planned ",(u.planned*100).toFixed(1),"%. The project value stands at ",d(h.revised,x),"with a progress value of ",d(h.progressValue,x),"."]}),e.jsxs("div",{className:"mt-4 flex gap-2 flex-wrap",children:[e.jsx(r,{children:"On Track"}),e.jsx(r,{children:"Weather Delays"}),e.jsx(r,{children:"Safety Compliant"})]})]})})]}),o===6&&e.jsx("div",{className:"space-y-6",children:e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(ne,{size:20,className:"text-indigo-600"})," Endorsement Sheet"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(i,{className:"p-4 bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Project Manager"}),e.jsx("p",{className:"text-sm font-bold",children:t.projectManager||"TBD"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Signature: ________________ Date: ",new Date().toLocaleDateString()]})]}),e.jsxs(i,{className:"p-4 bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Supervision Consultant"}),e.jsx("p",{className:"text-sm font-bold",children:t.consultantName||"BDA-BN-UDAYA JV"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Signature: ________________ Date: ",new Date().toLocaleDateString()]})]}),e.jsxs(i,{className:"p-4 bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Project Implementation Unit"}),e.jsx("p",{className:"text-sm font-bold",children:t.clientName||"PIU"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Signature: ________________ Date: ",new Date().toLocaleDateString()]})]}),e.jsxs(i,{className:"p-4 bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Funding Agency Representative"}),e.jsx("p",{className:"text-sm font-bold",children:"Asian Development Bank"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Signature: ________________ Date: ",new Date().toLocaleDateString()]})]})]})]})})}),o===7&&e.jsx("div",{className:"space-y-6",children:e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(ue,{size:20,className:"text-indigo-600"})," Issue Register"]}),e.jsxs(g,{children:[e.jsx(N,{children:e.jsxs(c,{children:[e.jsx(a,{children:"Issue ID"}),e.jsx(a,{children:"Description"}),e.jsx(a,{className:"text-right",children:"Priority"}),e.jsx(a,{className:"text-right",children:"Status"}),e.jsx(a,{className:"text-right",children:"Date Raised"}),e.jsx(a,{className:"text-right",children:"Target Resolution"})]})}),e.jsx(p,{children:[...t.ncrs.map((s,l)=>({id:`NCR-${l+1}`,description:s.description.substring(0,50),priority:"High",status:s.status,dateRaised:s.date||"TBD",targetResolution:"TBD"})),...t.rfis.map((s,l)=>({id:`RFI-${l+1}`,description:s.question.substring(0,50),priority:s.priority||"Medium",status:s.status,dateRaised:s.date||"TBD",targetResolution:s.responseDate||"TBD"}))].slice(0,10).map((s,l)=>e.jsxs(c,{children:[e.jsx(a,{children:s.id}),e.jsx(a,{children:s.description}),e.jsx(a,{className:"text-right",children:e.jsx(r,{variant:s.priority==="High"?"destructive":s.priority==="Medium"?"secondary":"default",children:s.priority})}),e.jsx(a,{className:"text-right",children:e.jsx(r,{variant:String(s.status)==="Closed"||String(s.status)===String(ee.CLOSED)?"default":"secondary",children:s.status})}),e.jsx(a,{className:"text-right",children:s.dateRaised}),e.jsx(a,{className:"text-right",children:s.targetResolution})]},l))})]})]})})}),o===8&&e.jsx("div",{className:"space-y-6",children:e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(fe,{size:20,className:"text-indigo-600"})," Site Photographs"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:((q=t.dailyReports)==null?void 0:q.slice(0,8).flatMap(s=>{var l;return(l=s.photos)==null?void 0:l.map((m,v)=>e.jsxs(i,{className:"p-2 text-center cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>alert(`Photo preview would open: ${m.url}`),children:[e.jsx("img",{src:m.url||"/placeholder-image.jpg",alt:m.caption||"Site photo",className:"w-full h-32 object-cover rounded"}),e.jsx("p",{className:"text-xs mt-2 truncate",children:m.caption||`Site photo ${v+1}`}),e.jsx("p",{className:"text-xs text-slate-500",children:s.date||"Unknown date"})]},`${s.id}-${v}`))}))||[]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(S,{variant:"outline",onClick:()=>alert("Photo gallery would open in full view"),children:[e.jsx(le,{size:16,className:"mr-2"}),"View All Photos (",((M=t.dailyReports)==null?void 0:M.reduce((s,l)=>{var m;return s+(((m=l.photos)==null?void 0:m.length)||0)},0))||0,")"]})})]})})}),o===1&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-black mb-4",children:"BOQ Progress Analysis"}),e.jsxs(g,{children:[e.jsx(N,{children:e.jsxs(c,{children:[e.jsx(a,{children:"Item No"}),e.jsx(a,{children:"Description"}),e.jsx(a,{className:"text-right",children:"Planned Qty"}),e.jsx(a,{className:"text-right",children:"Completed Qty"}),e.jsx(a,{className:"text-right",children:"Progress %"}),e.jsx(a,{className:"text-right",children:"Value"})]})}),e.jsx(p,{children:t.boq.slice(0,10).map((s,l)=>e.jsxs(c,{children:[e.jsx(a,{children:s.itemNo}),e.jsxs(a,{children:[s.description.substring(0,30),"..."]}),e.jsx(a,{className:"text-right",children:s.quantity}),e.jsx(a,{className:"text-right",children:s.completedQuantity}),e.jsx(a,{className:"text-right",children:e.jsxs(r,{variant:s.completedQuantity===s.quantity?"default":"secondary",children:[(s.completedQuantity/s.quantity*100).toFixed(1),"%"]})}),e.jsx(a,{className:"text-right",children:d(s.completedQuantity*s.rate,x)})]},l))})]})]})})}),e.jsx("div",{children:e.jsx(i,{className:"rounded-3xl h-full",children:e.jsxs(n,{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-black mb-4",children:"Progress Visualization"}),e.jsx("div",{className:"h-80 flex items-end gap-1",children:t.boq.slice(0,12).map((s,l)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsx("div",{className:`w-full rounded ${s.completedQuantity===s.quantity?"bg-green-500":"bg-indigo-500"}`,style:{height:`${s.completedQuantity/s.quantity*100}%`},title:`${s.description}: ${s.completedQuantity/s.quantity*100}%`}),e.jsx("p",{className:"text-xs mt-2 text-center",children:s.itemNo})]},l))})]})})}),e.jsx("div",{className:"lg:col-span-3",children:e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(Z,{size:20,className:"text-indigo-600"})," Pre-Construction Activities"]}),e.jsxs(g,{children:[e.jsx(N,{children:e.jsxs(c,{children:[e.jsx(a,{children:"Activity"}),e.jsx(a,{children:"Status"}),e.jsx(a,{className:"text-right",children:"Start Date"}),e.jsx(a,{className:"text-right",children:"End Date"}),e.jsx(a,{className:"text-right",children:"Progress"})]})}),e.jsx(p,{children:((Q=t.preConstruction)==null?void 0:Q.slice(0,5).map((s,l)=>e.jsxs(c,{children:[e.jsxs(a,{children:[s.description.substring(0,30),"..."]}),e.jsx(a,{children:e.jsx(r,{variant:s.status==="Completed"?"default":s.status==="In Progress"?"secondary":"destructive",children:s.status})}),e.jsx(a,{className:"text-right",children:s.startDate||"TBD"}),e.jsx(a,{className:"text-right",children:s.endDate||"TBD"}),e.jsxs(a,{className:"text-right",children:[s.progress||0,"%"]})]},l)))||[]})]})]})})})]}),o===2&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-black mb-4",children:"Financial Progress"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(i,{className:"p-4 text-center bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Budget Allocated"}),e.jsx("p",{className:"text-xl font-black",children:d(h.revised,x)})]}),e.jsxs(i,{className:"p-4 text-center bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Expended"}),e.jsx("p",{className:"text-xl font-black text-green-600",children:d(h.progressValue,x)})]}),e.jsxs(i,{className:"p-4 text-center bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Balance"}),e.jsx("p",{className:"text-xl font-black text-yellow-600",children:d(h.revised-h.progressValue,x)})]}),e.jsxs(i,{className:"p-4 text-center bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Utilization"}),e.jsxs("p",{className:"text-xl font-black",children:[(h.progressValue/h.revised*100).toFixed(1),"%"]})]})]})]})}),e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-black mb-4",children:"Financial Trend"}),e.jsx("div",{className:"h-48 flex items-end gap-1 mt-4",children:[60,65,70,75,80,85,90].map((s,l)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsx("div",{className:"w-full bg-green-500 rounded h-[${val}%]"}),e.jsxs("p",{className:"text-xs mt-2",children:[l+1,"M"]})]},l))})]})}),e.jsx(i,{className:"rounded-3xl lg:col-span-2",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(Ae,{size:20,className:"text-indigo-600"})," Cost Variance Analysis"]}),e.jsxs(g,{children:[e.jsx(N,{children:e.jsxs(c,{children:[e.jsx(a,{children:"BOQ Item"}),e.jsx(a,{className:"text-right",children:"Budgeted"}),e.jsx(a,{className:"text-right",children:"Actual"}),e.jsx(a,{className:"text-right",children:"Variance"}),e.jsx(a,{className:"text-right",children:"Variance %"}),e.jsx(a,{className:"text-right",children:"Status"})]})}),e.jsx(p,{children:t.boq.slice(0,5).map((s,l)=>{const m=s.quantity*s.rate,v=s.completedQuantity*s.rate,b=v-m,X=m!==0?b/m*100:0;return e.jsxs(c,{children:[e.jsxs(a,{children:[s.description.substring(0,30),"..."]}),e.jsx(a,{className:"text-right",children:d(m,x)}),e.jsx(a,{className:"text-right",children:d(v,x)}),e.jsx(a,{className:`text-right ${b>=0?"text-green-600":"text-red-600"}`,children:d(b,x)}),e.jsxs(a,{className:`text-right ${X>=0?"text-green-600":"text-red-600"}`,children:[X.toFixed(2),"%"]}),e.jsx(a,{className:"text-right",children:e.jsx(r,{variant:b>=0?"default":"destructive",children:b>=0?"Under Budget":"Over Budget"})})]},l)})})]})]})})]}),o===3&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(_,{size:20,className:"text-indigo-600"})," Personnel Deployment"]}),e.jsxs(g,{children:[e.jsx(N,{children:e.jsxs(c,{children:[e.jsx(a,{children:"Category"}),e.jsx(a,{className:"text-right",children:"Deployed"}),e.jsx(a,{className:"text-right",children:"Available"}),e.jsx(a,{className:"text-right",children:"Status"})]})}),e.jsxs(p,{children:[e.jsxs(c,{children:[e.jsx(a,{children:"Engineers"}),e.jsx(a,{className:"text-right",children:((B=t.personnel)==null?void 0:B.filter(s=>s.role==="Engineer"&&s.assigned).length)||0}),e.jsx(a,{className:"text-right",children:((I=t.personnel)==null?void 0:I.filter(s=>s.role==="Engineer"&&!s.assigned).length)||0}),e.jsx(a,{className:"text-right",children:e.jsx(r,{variant:"default",children:"Active"})})]}),e.jsxs(c,{children:[e.jsx(a,{children:"Skilled Workers"}),e.jsx(a,{className:"text-right",children:((E=t.personnel)==null?void 0:E.filter(s=>s.role==="Skilled Worker"&&s.assigned).length)||0}),e.jsx(a,{className:"text-right",children:((z=t.personnel)==null?void 0:z.filter(s=>s.role==="Skilled Worker"&&!s.assigned).length)||0}),e.jsx(a,{className:"text-right",children:e.jsx(r,{variant:"default",children:"Active"})})]}),e.jsxs(c,{children:[e.jsx(a,{children:"Unskilled Workers"}),e.jsx(a,{className:"text-right",children:((F=t.personnel)==null?void 0:F.filter(s=>s.role==="Unskilled Worker"&&s.assigned).length)||0}),e.jsx(a,{className:"text-right",children:((O=t.personnel)==null?void 0:O.filter(s=>s.role==="Unskilled Worker"&&!s.assigned).length)||0}),e.jsx(a,{className:"text-right",children:e.jsx(r,{variant:"default",children:"Active"})})]})]})]})]})}),e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(ve,{size:20,className:"text-indigo-600"})," Equipment Deployment"]}),e.jsxs(g,{children:[e.jsx(N,{children:e.jsxs(c,{children:[e.jsx(a,{children:"Equipment"}),e.jsx(a,{className:"text-right",children:"Active"}),e.jsx(a,{className:"text-right",children:"Maintenance"}),e.jsx(a,{className:"text-right",children:"Available"})]})}),e.jsx(p,{children:((L=t.fleet)==null?void 0:L.slice(0,5).map((s,l)=>e.jsxs(c,{children:[e.jsx(a,{children:s.name}),e.jsx(a,{className:"text-right",children:s.status==="Active"?1:0}),e.jsx(a,{className:"text-right",children:s.status==="Maintenance"?1:0}),e.jsx(a,{className:"text-right",children:s.status==="Available"?1:0})]},l)))||[]})]})]})}),e.jsx(i,{className:"rounded-3xl lg:col-span-2",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(le,{size:20,className:"text-indigo-600"})," Material Status"]}),e.jsxs(g,{children:[e.jsx(N,{children:e.jsxs(c,{children:[e.jsx(a,{children:"Material"}),e.jsx(a,{className:"text-right",children:"Required"}),e.jsx(a,{className:"text-right",children:"Received"}),e.jsx(a,{className:"text-right",children:"Stock"}),e.jsx(a,{className:"text-right",children:"Status"})]})}),e.jsx(p,{children:((V=t.inventory)==null?void 0:V.slice(0,5).map((s,l)=>e.jsxs(c,{children:[e.jsx(a,{children:s.itemName||s.name}),e.jsx(a,{className:"text-right",children:(s.requiredQuantity??s.quantity)||0}),e.jsx(a,{className:"text-right",children:s.receivedQuantity??0}),e.jsx(a,{className:"text-right",children:(s.currentQuantity??s.quantity)||0}),e.jsx(a,{className:"text-right",children:e.jsx(r,{variant:s.currentQuantity&&s.requiredQuantity?s.currentQuantity>=s.requiredQuantity?"default":"destructive":"secondary",children:s.currentQuantity&&s.requiredQuantity?s.currentQuantity>=s.requiredQuantity?"Sufficient":"Low Stock":"TBD"})})]},l)))||[]})]})]})})]}),o===4&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(se,{size:20,className:"text-indigo-600"})," Safety Status"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs(i,{className:"p-4 text-center bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Active NCRs"}),e.jsx("p",{className:"text-3xl font-black text-red-600",children:t.ncrs.filter(s=>s.status!=="Closed").length})]}),e.jsxs(i,{className:"p-4 text-center bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Open RFIs"}),e.jsx("p",{className:"text-3xl font-black text-yellow-600",children:t.rfis.filter(s=>s.status!==ee.CLOSED).length})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Recent Safety Incidents"}),t.ncrs.slice(0,3).map((s,l)=>e.jsxs(ae,{className:"mb-2",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsxs(te,{children:[s.description.substring(0,50),"..."]})]},l))]})]})}),e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(be,{size:20,className:"text-indigo-600"})," Environmental Status"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Tree Management"}),e.jsxs("p",{className:"text-xs",children:["Trees Removed: ",((U=w())==null?void 0:U.treesRemoved)||0]}),e.jsxs("p",{className:"text-xs",children:["Trees Planted: ",(($=w())==null?void 0:$.treesPlanted)||0]})]}),e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Water Sprinkling"}),e.jsxs("p",{className:"text-xs",children:["Last 7 days operations: ",((H=(W=w())==null?void 0:W.sprinklingLogs)==null?void 0:H.length)||0]})]})]})]})})]}),o===5&&e.jsx("div",{className:"space-y-6",children:e.jsx(i,{className:"rounded-3xl",children:e.jsxs(n,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2",children:[e.jsx(ye,{size:20,className:"text-indigo-600"})," Weather & Location"]}),f()?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs(i,{className:"p-4 text-center bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Temperature"}),e.jsxs("p",{className:"text-3xl font-black",children:[(G=f())==null?void 0:G.temp,"Â°C"]})]}),e.jsxs(i,{className:"p-4 text-center bg-slate-50",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Condition"}),e.jsx("p",{className:"text-3xl font-black",children:(K=f())==null?void 0:K.condition})]})]}):e.jsxs(ae,{children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx(te,{children:"Weather data not available for this project"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Impact on Schedule"}),e.jsx("p",{className:"text-sm",children:((J=f())==null?void 0:J.impactOnSchedule)==="None"?"No impact on construction activities":`Currently experiencing ${(Y=f())==null?void 0:Y.impactOnSchedule} impact`})]})]})})})]})]}),e.jsx(Se,{open:xe,onOpenChange:y,children:e.jsxs(we,{className:"sm:max-w-[425px]",children:[e.jsx(De,{children:e.jsx(_e,{children:"Export Monthly Progress Report"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Your report will be generated in the required MPR format with all project data as of ",new Date(P+"-01").toLocaleDateString("en-US",{year:"numeric",month:"long"}),"."]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Project Information"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Client, Contractor, Contract Details"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Physical Progress"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"BOQ Completion, Work Activities"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Financial Progress"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Budget Utilization, Cost Analysis"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Quality & Safety"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"NCRs, RFIs, Safety Records"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Environmental Data"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"EMP Implementation Status"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Endorsement Sheet"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Signatures from stakeholders"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-pink-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Issue Register"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Tracking of open issues"})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-bold mb-3",children:"Report Approval Workflow"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(k,{className:"w-8 h-8 bg-blue-100",children:e.jsx(_,{size:16,className:"text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"Project Manager Review"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Initial review and validation"})]}),e.jsx(r,{variant:"secondary",children:"Pending"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(k,{className:"w-8 h-8 bg-blue-100",children:e.jsx(se,{size:16,className:"text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"SDC Validation"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Technical validation by SDC"})]}),e.jsx(r,{variant:"outline",children:"Pending"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(k,{className:"w-8 h-8 bg-green-100",children:e.jsx(ne,{size:16,className:"text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"PIU Approval"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Final approval by PIU"})]}),e.jsx(r,{variant:"outline",children:"Pending"})]})]})]})]}),e.jsxs(ke,{children:[e.jsx(S,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),e.jsx(S,{onClick:he,children:"Export Report"})]})]})})]})};export{Ue as default};
